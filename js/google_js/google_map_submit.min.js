
var geocoder;var map;var selected_id="";var gmarkers=[];var propertyMarker_submit="";function google_map_submit_initialize(){if(jQuery("#googleMapsubmit").length===0){return}var f=jQuery("#property_latitude").val();var g=jQuery("#property_longitude").val();if(jQuery("#agency_lat").length>0){f=jQuery("#agency_lat").val();g=jQuery("#agency_long").val()}if(jQuery("#developer_lat").length>0){f=jQuery("#developer_lat").val();g=jQuery("#developer_long").val()}if(f===""||typeof f==="undefined"){f=google_map_submit_vars.general_latitude}if(g===""||typeof g==="undefined"){g=google_map_submit_vars.general_longitude}if(parseInt(mapfunctions_vars.geolocation_type)==1){geocoder=new google.maps.Geocoder();var b={flat:false,noClear:false,zoom:17,scrollwheel:false,draggable:true,disableDefaultUI:false,center:new google.maps.LatLng(f,g),mapTypeId:google.maps.MapTypeId.ROADMAP,gestureHandling:"cooperative"};if(document.getElementById("googleMapsubmit")){map=new google.maps.Map(document.getElementById("googleMapsubmit"),b)}else{return}google.maps.visualRefresh=true;var a=new google.maps.LatLng(f,g);wpestate_placeSavedMarker(a);if(mapfunctions_vars.map_style!==""){var e=JSON.parse(mapfunctions_vars.map_style);map.setOptions({styles:e})}google.maps.event.addListener(map,"click",function(i){wpestate_placeMarker(i.latLng)})}else{var d=L.latLng(f,g);map=L.map("googleMapsubmit",{center:d,zoom:15,});var h=wpresidence_open_stret_tile_details();map.addLayer(h);map.on("click",function(j){map.removeLayer(propertyMarker_submit);var i=L.latLng(j.latlng);propertyMarker_submit=L.marker(j.latlng).addTo(map);propertyMarker_submit.bindPopup('<div class="submit_leaflet_admin">Latitude: '+j.latlng.lat+" Longitude: "+j.latlng.lng+"</div>").openPopup();jQuery("#property_latitude").val(j.latlng.lat);jQuery("#property_longitude").val(j.latlng.lng);jQuery("#agency_lat").val(j.latlng.lat);jQuery("#agency_long").val(j.latlng.lng);jQuery("#developer_lat").val(j.latlng.lat);jQuery("#developer_long").val(j.latlng.lng)});var c=L.latLng(d);propertyMarker_submit=L.marker(c).addTo(map);propertyMarker_submit.bindPopup('<div class="submit_leaflet_admin">Latitude: '+f+" Longitude: "+g+"</div>")}}function wpestate_placeSavedMarker(b){wpestate_removeMarkers();var a=new google.maps.Marker({position:b,map:map});gmarkers.push(a);var c=new google.maps.InfoWindow({content:"Latitude: "+b.lat()+"<br>Longitude: "+b.lng()});c.open(map,a)}function wpestate_codeAddress(){var a=document.getElementById("property_address").value;var h=jQuery("#property_city_submit").val();var d=a;var c,b;if(h!=="none"){d=d+","+h}var e=document.getElementById("property_county").value;if(e){d=d+","+e}var g=document.getElementById("property_country").value;if(g){d=d+","+g}if(parseInt(mapfunctions_vars.geolocation_type)==1){geocoder.geocode({address:d},function(j,i){if(i==google.maps.GeocoderStatus.OK){c=j[0].geometry.location.lat();b=j[0].geometry.location.lng();wpresidence_submit_set_postion(c,b)}else{alert(google_map_submit_vars.geo_fails+i)}})}else{if(parseInt(mapfunctions_vars.geolocation_type)==2){var f=jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",addressdetails:"1",q:d}).done(function(i){if(i==""){alert(google_map_submit_vars.geo_fails+status)}else{c=i[0].lat;b=i[0].lon;wpresidence_submit_set_postion(c,b)}}).fail(function(i){}).always(function(){})}}}function wpresidence_submit_set_postion(e,d){wpestate_removeMarkers();if(parseInt(mapfunctions_vars.geolocation_type)==1){var g=new google.maps.LatLng(e,d);map.setCenter(g);var a=new google.maps.Marker({map:map,position:g});gmarkers.push(a);var f=new google.maps.InfoWindow({content:"Latitude: "+e+"<br>Longitude: "+d});f.open(map,a);document.getElementById("property_latitude").value=e;document.getElementById("property_longitude").value=d}else{var c=L.latLng(e,d);var b=L.latLng(c);map.removeLayer(propertyMarker_submit);propertyMarker_submit=L.marker(b).addTo(map);propertyMarker_submit.bindPopup('<div class="submit_leaflet_admin">Latitude: '+e+" Longitude: "+d+"</div>");setTimeout(function(){propertyMarker_submit.openPopup()},600);propertyMarker_submit.fire("click");document.getElementById("property_latitude").value=e;document.getElementById("property_longitude").value=d;map.panTo(new L.LatLng(e,d))}}function wpestate_codeAddress_agency(f,k,j,h,g){var i=jQuery(f).val();var e=jQuery(k).val();var d=i+","+e;var b=jQuery(j).val();var a="";if(b){d=d+","+b}a=i+","+e;if(wp_estate_kind_of_map==1){geocoder.geocode({address:d},function(n,m){if(m==google.maps.GeocoderStatus.OK){map.setCenter(n[0].geometry.location);var l=new google.maps.Marker({map:map,position:n[0].geometry.location});gmarkers.push(l);var o=new google.maps.InfoWindow({content:"Latitude: "+n[0].geometry.location.lat()+"<br>Longitude: "+n[0].geometry.location.lng()});o.open(map,l);jQuery(h).val(n[0].geometry.location.lat());jQuery(g).val(n[0].geometry.location.lng())}else{alert(google_map_submit_vars.geo_fails+m)}})}else{if(wp_estate_kind_of_map==2){var c=jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",addressdetails:"1",q:a}).done(function(p){if(typeof(p[0])!="undefined"){var o=p[0].lat;var n=p[0].lon;var m=L.latLng(o,n);var l=L.latLng(m);map.removeLayer(propertyMarker_submit);propertyMarker_submit=L.marker(l).addTo(map);propertyMarker_submit.bindPopup('<div class="submit_leaflet_admin">Latitude: '+o+" Longitude: "+n+"</div>");setTimeout(function(){propertyMarker_submit.openPopup()},600);map.panTo(new L.LatLng(o,n));jQuery(h).val(p[0].lat);jQuery(g).val(p[0].lon)}else{alert(google_map_submit_vars.geo_fails+status)}}).fail(function(){}).always(function(){})}}}function wpestate_placeMarker(b){wpestate_removeMarkers();var a=new google.maps.Marker({position:b,map:map});gmarkers.push(a);var d=new google.maps.InfoWindow({content:"Latitude: "+b.lat()+"<br>Longitude: "+b.lng()});var c;d.open(map,a);c=document.getElementById("property_latitude");if(c!==null){document.getElementById("property_latitude").value=b.lat();document.getElementById("property_longitude").value=b.lng()}c=document.getElementById("agency_lat");if(c!==null){document.getElementById("agency_lat").value=b.lat();document.getElementById("agency_long").value=b.lng()}c=document.getElementById("developer_lat");if(c!==null){document.getElementById("developer_lat").value=b.lat();document.getElementById("developer_long").value=b.lng()}}function wpestate_removeMarkers(){for(var a=0;a<gmarkers.length;a++){if(parseInt(mapfunctions_vars.geolocation_type)==1){gmarkers[a].setMap(null)}else{map.removeLayer(gmarkers[a])}}}jQuery("#open_google_submit").on("click",function(){setTimeout(function(){initialize();google.maps.event.trigger(map,"resize")},300)});jQuery("#google_capture").on("click",function(a){a.preventDefault();wpestate_removeMarkers();wpestate_codeAddress()});if(typeof google==="object"&&typeof google.maps==="object"){google.maps.event.addDomListener(window,"load",google_map_submit_initialize)}else{google_map_submit_initialize()}jQuery("#google_agency_location").on("click",function(a){a.preventDefault();wpestate_removeMarkers();wpestate_codeAddress_agency("#agency_address","#agency_city","#agency_county","#agency_lat","#agency_long")});jQuery("#google_developer_location").on("click",function(a){a.preventDefault();wpestate_removeMarkers();wpestate_codeAddress_agency("#developer_address","#developer_city","#developer_county","#developer_lat","#developer_long")});jQuery(document).ready(function(h){h("#imagelist").sortable({revert:true,update:function(k,l){var j,i;j="";h("#imagelist .uploaded_images").each(function(){i=h(this).attr("data-imageid");if(typeof i!="undefined"){j=j+","+i}});h("#attachid").val(j)},});var f,e;var c={types:["(cities)"],};var d={establishment:"long_name",street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"long_name",administrative_area_level_2:"long_name",country:"long_name",postal_code:"short_name",postal_code_prefix:"short_name",neighborhood:"long_name"};if(google_map_submit_vars.enable_auto==="yes"){if(document.getElementById("property_address")){if(parseInt(mapfunctions_vars.geolocation_type)==1){f=new google.maps.places.Autocomplete((document.getElementById("property_address")),{types:["geocode"],partial_match:true});var b=document.getElementById("property_address");google.maps.event.addDomListener(b,"keydown",function(i){if(i.keyCode==13){i.stopPropagation();i.preventDefault()}});google.maps.event.addListener(f,"place_changed",function(j){var i=f.getPlace();a(i)});e=new google.maps.places.Autocomplete((document.getElementById("property_city_submit")),{types:["(cities)"]});google.maps.event.addListener(e,"place_changed",function(){var i=e.getPlace();a(i)})}else{if(parseInt(mapfunctions_vars.geolocation_type)==2){jQuery("#property_address").autocomplete({source:function(j,i){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:j.term,addressdetails:"1",},function(k){if(!k.length){i([{value:"",label:"there are no results"}]);return}i(k.map(function(l){var m={label:l.display_name,latitude:l.lat,longitude:l.lon,value:l.display_name,};if(typeof(l.address)!="undefined"){m.county=l.address.county}if(typeof(l.address)!="undefined"){m.city=l.address.city}if(typeof(l.address)!="undefined"){m.state=l.address.state}if(typeof(l.address)!="undefined"){m.country=l.address.country}if(typeof(l.address)!="undefined"){m.zip=l.address.postcode}return m}))},"json")},select:function(k,l){var j=l.item.latitude;var i=l.item.longitude;h("#property_zip").val(l.item.zip);h("#property_county").val(l.item.county);h("#property_city_submit").val(l.item.city);h("#property_country").val(l.item.country);h("#property_city_submit").val(l.item.city);wpresidence_submit_set_postion(j,i)}})}}}}function a(j){h("#property_area").val("");h("#property_zip").val("");h("#property_county").val("");h("#property_city_submit").val("");for(var m=0;m<j.address_components.length;m++){var l=j.address_components[m].types[0];var k="";var n=j.address_components[m][d[l]];if(l==="street_number"||l==="route"){}else{if(l==="neighborhood"){h("#property_area").val(n)}else{if(l==="postal_code_prefix"){h("#property_zip").val(n)}else{if(l==="postal_code"){h("#property_zip").val(n)}else{if(l==="administrative_area_level_2"){h("#property_county").val(n)}else{if(l==="administrative_area_level_1"){h("#property_county").val(n)}else{if(l==="locality"){h("#property_city_submit").val(n)}else{if(l==="country"){h("#property_country").val(n)}else{}}}}}}}}}wpestate_codeAddress()}jQuery("#google_capture2").on("click",function(i){i.preventDefault();g()});function g(){var i=document.getElementById("property_address").value;var m=jQuery("#property_city_submit").val();var j=i+","+m;if(document.getElementById("property_state")){var k=document.getElementById("property_state").value;if(k){j=j+","+k}}if(document.getElementById("property_country")){var l=document.getElementById("property_country").value;if(l){j=j+","+l}}geocoder.geocode({address:j},function(p,o){if(o==google.maps.GeocoderStatus.OK){map.setCenter(p[0].geometry.location);var n=new google.maps.Marker({map:map,position:p[0].geometry.location});var q=new google.maps.InfoWindow({content:"Latitude: "+p[0].geometry.location.lat()+"<br>Longitude: "+p[0].geometry.location.lng()});q.open(map,n);document.getElementById("property_latitude").value=p[0].geometry.location.lat();document.getElementById("property_longitude").value=p[0].geometry.location.lng()}else{alert(google_map_submit_vars.geo_fails+o)}})}});