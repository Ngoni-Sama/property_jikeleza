
var pin_images=mapfunctions_vars.pin_images;var images=jQuery.parseJSON(pin_images);var ipad_time=0;var infobox_id=0;var shape={coord:[1,1,1,38,38,59,59,1],type:"poly"};var mcOptions;var mcluster;var clusterStyles;var pin_hover_storage;var first_time_wpestate_show_inpage_ajax_half=0;var panorama;var infoBox_sh=null;var poi_marker_array=[];var poi_type="";var placeCircle="";var initialGeop=0;var heading=0;var width_browser=null;var infobox_width=null;var wraper_height=null;var info_image=null;var vertical_pan=-190;var vertical_off=150;var curent_gview_lat=jQuery("#gmap_wrapper").attr("data-cur_lat");var curent_gview_long=jQuery("#gmap_wrapper").attr("data-cur_long");var bounds_list;var circleLayer="";function wpestate_agency_map_function(){var g=jQuery("#agency_map").attr("data-cur_lat");var c=jQuery("#agency_map").attr("data-cur_long");if(mapfunctions_vars.geolocation_type==1){var b={flat:false,noClear:false,zoom:15,scrollwheel:false,draggable:true,center:new google.maps.LatLng(g,c),streetViewControl:false,disableDefaultUI:true,mapTypeId:mapfunctions_vars.type.toLowerCase(),gestureHandling:"cooperative"};var d=new google.maps.Map(document.getElementById("agency_map"),b);if(mapfunctions_vars.map_style!==""){var e=JSON.parse(mapfunctions_vars.map_style);d.setOptions({styles:e})}google.maps.visualRefresh=true;google.maps.event.trigger(d,"resize");var f=new google.maps.LatLng(g,c);var a=new google.maps.Marker({position:f,map:d,icon:wpesate_custompin_agency(),shape:shape,title:"we are here",zIndex:1,infoWindowIndex:0})}else{wpresidence_agency_dev_map(g,c,"agency_map")}}function wpresidence_agency_dev_map(h,a,e){var i=L.latLng(h,a);var c=L.map(e,{center:i,zoom:7,});var d=wpresidence_open_stret_tile_details();c.addLayer(d);var j=L.latLng(h,a);var f={iconUrl:images.single_pin,iconSize:[44,50],iconAnchor:[20,50],popupAnchor:[1,-50]};var b={riseOnHover:true};b.icon=L.icon(f);var g=L.marker(j,b);g.addTo(c)}function wpesate_custompin_agency(){var a={url:images.single_pin,size:new google.maps.Size(59,59),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,59)};return a}function wpestate_map_shortcode_function(){var n=parseInt(jQuery("#googleMap_shortcode").attr("data-post_id"),10);var G=jQuery("#googleMap_shortcode").attr("data-cur_lat");var b=jQuery("#googleMap_shortcode").attr("data-cur_long");var H;var r="";var C=[];if(typeof googlecode_property_vars==="undefined"){H=5;heading=0}else{H=googlecode_property_vars.page_custom_zoom;heading=parseInt(googlecode_property_vars.camera_angle)}var I=1;var D=n;var A=G;var t=b;var y=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-title"));var x=jQuery("#googleMap_shortcode").attr("data-pin");var c=1;var d=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-thumb"));var z=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-price"));var v=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-single-first-type"));var k=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-single-first-action"));var g=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-prop_url"));var o="";var B="";var E=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-rooms"));var q=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-bathrooms"));var j=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-size"));var s=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-single-first-type"));var u=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-single-first-action"));var h="";var p="";var K=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-pin_price"));var e=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-clean_price"));if(wp_estate_kind_of_map==2){var F=L.latLng(G,b);r=L.map("googleMap_shortcode",{center:F,zoom:H}).on("load",function(i){jQuery("#gmap-loading").remove()});wpresidence_leaflet_initialize_map_common(r);wpestate_createMarker_sh_leaflet(K,infoBox_sh,C,r,p,j,I,D,A,t,x,y,c,d,z,v,k,g,o,B,E,q,e,s,u)}else{if(jQuery("#googleMap_shortcode").length>0){var J={flat:false,noClear:false,zoom:parseInt(H),scrollwheel:false,draggable:true,center:new google.maps.LatLng(G,b),streetViewControl:false,disableDefaultUI:true,mapTypeId:mapfunctions_vars.type.toLowerCase(),gestureHandling:"cooperative"};r=new google.maps.Map(document.getElementById("googleMap_shortcode"),J);google.maps.visualRefresh=true;google.maps.event.trigger(r,"resize");width_browser=jQuery(window).width();infobox_width=700;vertical_pan=-215;if(width_browser<900){infobox_width=500}if(width_browser<600){infobox_width=400}if(width_browser<400){infobox_width=200}var f=document.createElement("div");var l={content:f,disableAutoPan:true,maxWidth:infobox_width,boxClass:"mybox",zIndex:null,closeBoxMargin:"-13px 0px 0px 0px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:true};infoBox_sh=new InfoBox(l);if(mapfunctions_vars.map_style!==""){var w=JSON.parse(mapfunctions_vars.map_style);r.setOptions({styles:w})}wpestate_createMarker_sh(K,infoBox_sh,C,r,p,j,I,D,A,t,x,y,c,d,z,v,k,g,o,B,E,q,e,s,u);var a=new google.maps.LatLng(G,b);if(typeof(m)==="undefined"){var m}m=r.getStreetView();m.setPosition(a);m.setPov(({heading:heading,pitch:0}));jQuery("#slider_enable_street_sh").on("click",function(){var i=jQuery("#googleMap_shortcode").attr("data-cur_lat");var M=jQuery("#googleMap_shortcode").attr("data-cur_long");var N=new google.maps.LatLng(i,M);m.setPosition(N);m.setVisible(true);jQuery("#gmapzoomminus_sh,#gmapzoomplus_sh,#slider_enable_street_sh").hide()});google.maps.event.addListener(m,"closeclick",function(){jQuery("#gmapzoomminus_sh,#gmapzoomplus_sh,#slider_enable_street_sh").show()});google.maps.event.trigger(C[0],"click");setTimeout(function(){google.maps.event.trigger(r,"resize");r.setCenter(C[0].position)},300);wpestate_initialize_poi(r,2)}}if(document.getElementById("gmapzoomplus_sh")){jQuery("#gmapzoomplus_sh").on("click",function(){var i=parseInt(r.getZoom(),10);i++;if(i>20){i=20}r.setZoom(i)})}if(document.getElementById("gmapzoomminus_sh")){jQuery("#gmapzoomminus_sh").on("click",function(){var i=parseInt(r.getZoom(),10);i--;if(i<0){i=0}r.setZoom(i)})}if(wp_estate_kind_of_map==2){setTimeout(function(){r.invalidateSize()},1000)}else{setTimeout(function(){google.maps.event.trigger(r,"resize")},1000)}jQuery(".shtabmap,.shacctab").on("click",function(i){if(wp_estate_kind_of_map==2){setTimeout(function(){r.invalidateSize()},100)}else{setTimeout(function(){google.maps.event.trigger(r,"resize")},100)}})}function wpestate_createMarker_sh_leaflet(P,n,J,v,t,k,T,K,G,y,C,E,f,g,F,B,m,j,r,H,N,u,h,w,A){var z=document.createElement("div");z.className="leafinfobox-wrapper";var O="";var s=0;var x=" price_infobox ";if(mapfunctions_vars.useprice==="yes"){x=" openstreet_map_price_infobox "}var d="";if(g===""){d=mapfunctions_vars.path+"/idxdefault.jpg"}else{d=g}var l=decodeURIComponent(B.replace(/-/g," "));var e=decodeURIComponent(m.replace(/-/g," "));var S=decodeURIComponent(w.replace(/-/g," "));var R=decodeURIComponent(A.replace(/-/g," "));var c=mapfunctions_vars.in_text;if(l===""||e===""){c=" "}c=" / ";var p,D;var q;if(u!=""){q='<span id="infobath">'+u+" "+mapfunctions_vars.ba+"</span>"}else{q=""}var D;if(N!=""){D='<span id="inforoom">'+N+" "+mapfunctions_vars.bd+"</span>"}else{D=""}var V;if(k!=""){V='<span id="infosize">'+k+"</span>"}else{V=""}var E=E.substr(0,30);if(E.length>30){E=E+"..."}O+=wpestate_generate_infobox_leaflet(x,E,j,d,F,h,V,q,D);var b={riseOnHover:true};var a=L.latLng(G,y);var M="";if(mapfunctions_vars.useprice==="yes"){var U="wpestate_marker openstreet_price_marker "+wpestate_makeSafeForCSS(w.trim())+" "+wpestate_makeSafeForCSS(A.trim());var Q='<div class="'+U+'">';if(typeof(F)!=="undefined"){if(mapfunctions_vars.use_price_pins_full_price==="no"){Q+='<div class="interior_pin_price">'+P+"</div>"}else{Q+='<div class="interior_pin_price">'+F+"</div>"}}Q+="</div>";var o=L.divIcon({className:"someclass",iconSize:new L.Point(0,0),html:Q});M=L.marker(a,{icon:o})}else{var I={iconUrl:wprentals_custompin_leaflet(C),iconSize:[44,50],iconAnchor:[20,50],popupAnchor:[1,-50]};b.icon=L.icon(I);M=L.marker(a,b)}M.idul=K;M.pin=C;M.addTo(v);J.push(M);if(typeof(bounds_list)!=="undefined"){bounds_list.extend(M.getLatLng())}else{bounds_list=L.latLngBounds(M.getLatLng(),M.getLatLng())}z.innerHTML=O;M.bindPopup(O);M.fire("click").openPopup()}function wpestate_createMarker_sh(I,h,D,q,o,e,J,E,B,t,y,z,a,b,A,x,f,d,m,C,G,p,c,r,w){var F="";var l=new google.maps.LatLng(B,t);var n=0;var s=" price_infobox ";if(mapfunctions_vars.useprice==="yes"){l=new google.maps.LatLng(B,t);var u=jQuery("<textarea />").html(z).text();var k=999;n=11;var H=A;var j=parseFloat(wpestate_getCookie_map("my_custom_curr_pos"));if(!isNaN(j)&&j!==-1){var g=wpestate_get_price_currency(c,c);var v=A.match("</span>(.*)<span class=");if(v!==null){H=A.replace(v[1],g)}}K=new WpstateMarker(n,l,q,u,a,b,E,H,I,x,f,d,J,G,p,c,e,r,w,y,k)}else{s=" classic_info ";var K=new google.maps.Marker({position:l,map:q,icon:wpestate_custompin(y),shape:shape,title:z,zIndex:a,image:b,idul:E,price:A,category:x,action:f,link:d,city:m,area:C,infoWindowIndex:J,rooms:G,baths:p,cleanprice:c,size:e,county_state:o,category_name:r,action_name:w})}D.push(K);google.maps.event.addListener(K,"click",function(){if(this.image===""){info_image='<img src="'+mapfunctions_vars.path+'/idxdefault.jpg"  />'}else{info_image=this.image}var M=decodeURIComponent(this.category.replace(/-/g," "));var P=decodeURIComponent(this.action.replace(/-/g," "));var O=decodeURIComponent(this.category_name.replace(/-/g," "));var Q=decodeURIComponent(this.action_name.replace(/-/g," "));var i=mapfunctions_vars.in_text;if(M===""||P===""){i=" "}var N;if(this.baths!=""){N='<span id="infobath">'+this.baths+" "+mapfunctions_vars.ba+"</span>"}else{N=""}var R;if(this.rooms!=""){R='<span id="inforoom">'+this.rooms+" "+mapfunctions_vars.bd+"</span>"}else{R=""}var S;if(this.size!=""){S='<span id="infosize">'+this.size;S=S+"</span>"}else{S=""}var T=this.title.substr(0,30);if(this.title.length>30){T=T+"..."}h.setContent(wpestate_generate_infobox_sh(s,T,d,info_image,A,c,S,N,R));h.open(q,this);q.setCenter(this.position);if(control_vars.show_adv_search_map_close==="no"){$(".search_wrapper").addClass("adv1_close");wpestate_adv_search_click()}wpestate_close_adv_search()})}function wpestate_change_map_type(a){if(a==="map-view-roadmap"){map.setMapTypeId(google.maps.MapTypeId.ROADMAP)}else{if(a==="map-view-satellite"){map.setMapTypeId(google.maps.MapTypeId.SATELLITE)}else{if(a==="map-view-hybrid"){map.setMapTypeId(google.maps.MapTypeId.HYBRID)}else{if(a==="map-view-terrain"){map.setMapTypeId(google.maps.MapTypeId.TERRAIN)}}}}}function wpestate_setMarkers(A,z,o){var c;var w;var m=parseInt(jQuery("#gmap_wrapper").attr("data-post_id"));if(isNaN(m)){m=parseInt(jQuery("#googleMapSlider").attr("data-post_id"),10)}var d=parseInt(mapfunctions_vars.open_height,10);var k=parseInt(mapfunctions_vars.closed_height,10);width_browser=jQuery(window).width();infobox_width=700;vertical_pan=-215;if(width_browser<900){infobox_width=500}if(width_browser<600){infobox_width=400}if(width_browser<400){infobox_width=200}bounds=new google.maps.LatLngBounds();for(var x=0;x<z.length;x++){var t=z[x];var s=t[10];var e=t[1];var C=t[2];var B=decodeURIComponent(t[0]);var h=t[8];var l=t[3];var r=decodeURIComponent(t[4]);var v=decodeURIComponent(t[5]);var j=decodeURIComponent(t[6]);var q=decodeURIComponent(t[7]);var g=decodeURIComponent(t[9]);var f=t[11];var y=t[12];var b=t[13];var p=t[14];var n=decodeURIComponent(t[15]);var u=decodeURIComponent(t[16]);var a=decodeURIComponent(t[17]);wpestate_createMarker(a,p,x,s,e,C,h,B,l,r,v,j,q,g,y,b,f,n,u);if(m===s){found_id=x}}wpestate_map_cluster();if(!jQuery("body").hasClass("single-estate_property")){oms=new OverlappingMarkerSpiderfier(A,{markersWontMove:true,markersWontHide:true,keepSpiderfied:true,legWeight:2});wpestate_setOms(gmarkers)}if(o===1){if(!bounds.isEmpty()){wpestate_fit_bounds(bounds)}else{wpestate_fit_bounds_nolsit()}}if(mapfunctions_vars.generated_pins!=="0"){w=new google.maps.LatLng(e,C)}}function wpestate_createMarker(a,r,z,v,d,F,j,E,n,t,y,l,s,g,D,b,h,p,x){var w=new google.maps.LatLng(d,F);var C=jQuery("<textarea />").html(E).text();var A=0;var o=" price_infobox ";var q=document.createElement("div");var u={content:q,disableAutoPan:true,maxWidth:infobox_width,boxClass:"mybox",zIndex:null,closeBoxMargin:"-13px 0px 0px 0px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:true};infoBox=new InfoBox(u);if(mapfunctions_vars.useprice==="yes"){var B=y;var c=parseFloat(wpestate_getCookie_map("my_custom_curr_pos"));if(!isNaN(c)&&c!==-1){var k=wpestate_get_price_currency(h,h);var e=y.match("</span>(.*)<span class=");if(e!==null){B=y.replace(e[1],k)}}var m=new google.maps.LatLng(d,F);f=new WpstateMarker(A,m,map,C,n,t,v,B,a,l,s,g,z,D,b,h,r,p,x,j,z)}else{o=" classic_info ";var f=new google.maps.Marker({position:w,map:map,icon:wpestate_custompin(j),shape:shape,title:C,zIndex:n,image:t,idul:v,price:y,category:l,action:s,link:g,infoWindowIndex:z,rooms:D,baths:b,cleanprice:h,size:r,category_name:p,action_name:x})}gmarkers.push(f);bounds.extend(f.getPosition());google.maps.event.addListener(f,"click",function(G){if(typeof(is_map_shortcode)==="undefined"){wpestate_map_callback(wpestate_new_open_close_map);google.maps.event.trigger(map,"resize")}if(this.image===""){info_image='<img src="'+mapfunctions_vars.path+'/idxdefault.jpg" />'}else{info_image=this.image}var H=decodeURIComponent(this.category.replace(/-/g," "));var K=decodeURIComponent(this.action.replace(/-/g," "));var J=decodeURIComponent(this.category_name.replace(/-/g," "));var M=decodeURIComponent(this.action_name.replace(/-/g," "));var i=mapfunctions_vars.in_text;if(H===""||K===""){i=" "}var I;if(this.baths!=""){I='<span id="infobath">'+this.baths+" "+mapfunctions_vars.ba+"</span>"}else{I=""}var N;if(this.rooms!=""){N='<span id="inforoom">'+this.rooms+" "+mapfunctions_vars.bd+"</span>"}else{N=""}var O;if(this.size!=""){O='<span id="infosize">'+this.size;O=O+"</span>"}else{O=""}var P=this.title.substr(0,30);if(this.title.length>30){P=P+"..."}infoBox.setContent(wpestate_generate_infobox(o,P,g,info_image,y,h,O,I,N));infoBox.open(map,this);map.setCenter(this.position);if(control_vars.show_adv_search_map_close==="no"){$(".search_wrapper").addClass("adv1_close");wpestate_adv_search_click()}wpestate_close_adv_search()})}function wpestate_pan_to_last_pin(a){map.setCenter(a)}function wpestate_generate_infobox(i,h,g,j,e,a,f,c,d){var b='<div class="info_details '+i+'"><span id="infocloser" onClick=\'javascript:infoBox.close();\' ></span>';b=b+'<div class="infobox_wrapper_image"> <a href="'+g+'">'+j+"</a></div>";b=b+'<div class="infobox_title"><a href="'+g+'" id="infobox_title">'+h+"</a></div>";b=b+'<div class="prop_pricex">'+e+"</div>";b=b+'<div class="infobox_details">'+d+" "+c+" "+f+"</div></div>";return b}function wpestate_generate_infobox_sh(i,h,g,j,e,a,f,c,d){var b='<div class="info_details '+i+'"><span id="infocloser" onClick=\'javascript:infoBox_sh.close();\' ></span>';b=b+'<div class="infobox_wrapper_image"> <a href="'+g+'">'+j+"</a></div>";b=b+'<div class="infobox_title"><a href="'+g+'" id="infobox_title">'+h+"</a></div>";b=b+'<div class="prop_pricex">'+e+"</div>";b=b+'<div class="infobox_details">'+d+" "+c+" "+f+"</div></div>";return b}function wpestate_generate_infobox_leaflet(i,h,g,j,e,a,f,c,d){var h=h.substr(0,32);if(h.length>32){h=h+"..."}var b='<div class="info_details '+i+'"><span id="infocloser" onClick=\'javascript:jQuery(".leaflet-popup-close-button")[0].click();\' ></span>';b=b+'<div class="infobox_wrapper_image"> <a href="'+g+'">'+j+"</a></div>";b=b+'<div class="infobox_title"><a href="'+g+'" id="infobox_title">'+h+"</a></div>";b=b+'<div class="prop_pricex">'+e+"</div>";b=b+'<div class="infobox_details">'+d+" "+c+" "+f+"</div></div>";return b}function wpestate_setOms(a){for(var b=0;b<a.length;b++){if(typeof oms!=="undefined"){oms.addMarker(a[b])}else{}}}function wpestate_set_google_search(d){if(parseInt(mapbase_vars.wp_estate_kind_of_map)==2||jQuery("#google-default-search").length===0){return}var b,e,c,a;b=(document.getElementById("google-default-search"));e=new google.maps.places.SearchBox(b);google.maps.event.addListener(e,"places_changed",function(){c=e.getPlaces();if(c.length==0){return}var h=new google.maps.LatLngBounds();for(var g=0;a=c[g];g++){var j={url:a.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};var f=new google.maps.Marker({map:d,icon:j,title:a.name,position:a.geometry.location});gmarkers.push(f);h.extend(a.geometry.location)}d.fitBounds(h);if(!h.isEmpty()){wpestate_fit_bounds(h)}else{wpestate_fit_bounds_nolsit()}d.setZoom(15)});google.maps.event.addListener(d,"bounds_changed",function(){var f=d.getBounds();e.setBounds(f)})}function wpestate_fit_bounds_nolsit(){map.setZoom(3)}function wpestate_fit_bounds(a){if(placeCircle!=""){map.fitBounds(placeCircle.getBounds())}else{map.fitBounds(a);google.maps.event.addListenerOnce(map,"idle",function(){if(map.getZoom()>15){map.setZoom(15)}})}}function wpestate_new_open_close_map(c){if(jQuery("#gmap_wrapper").hasClass("fullmap")){return}if(mapfunctions_vars.open_close_status!=="1"){var d=jQuery("#googleMap").outerHeight();var f=parseInt(mapfunctions_vars.closed_height,10);var b=parseInt(mapfunctions_vars.open_height,10);var a=b;var e=b;if(infoBox!==null){infoBox.close()}if(d===f){a=b;if(Modernizr.mq("only all and (max-width: 940px)")){e=b}else{jQuery("#gmap-menu").show();e=b}wpestate_new_show_advanced_search();vertical_off=0;jQuery("#openmap").empty().append('<i class="fas fa-angle-up"></i>'+mapfunctions_vars.close_map)}else{if(c===2){jQuery("#gmap-menu").hide();jQuery("#advanced_search_map_form").hide();a=e=f;wpestate_new_hide_advanced_search();vertical_off=150}}jQuery("#gmap_wrapper").css("height",e+"px");jQuery("#googleMap").css("height",a+"px");jQuery(".tooltip").fadeOut("fast");if(wp_estate_kind_of_map===1){setTimeout(function(){google.maps.event.trigger(map,"resize")},300)}}}function wpestate_map_cluster(){if(mapfunctions_vars.user_cluster==="yes"){clusterStyles=[{textColor:"#ffffff",opt_textColor:"#ffffff",url:images.cloud_pin,height:72,width:72,textSize:15,}];mcOptions={gridSize:50,ignoreHidden:true,maxZoom:parseInt(mapfunctions_vars.zoom_cluster,10),styles:clusterStyles};mcluster=new MarkerClusterer(map,gmarkers,mcOptions);mcluster.setIgnoreHidden(true)}}if(document.getElementById("gmapzoomplus")){jQuery("#gmapzoomplus").on("click",function(){var a=parseInt(map.getZoom(),10);a++;if(a>20){a=20}map.setZoom(a)})}if(document.getElementById("gmapzoomminus")){jQuery("#gmapzoomminus").on("click",function(){var a=parseInt(map.getZoom(),10);a--;if(a<0){a=0}map.setZoom(a)})}if(document.getElementById("geolocation-button")){jQuery("#geolocation-button").on("click",function(){wpestate_myposition(map);wpestate_close_adv_search()})}if(document.getElementById("mobile-geolocation-button")){jQuery("#mobile-geolocation-button").on("click",function(){wpestate_myposition(map);wpestate_close_adv_search()})}function wpestate_myposition(b){if(navigator.geolocation){var a;if(location.protocol==="https:"){navigator.geolocation.getCurrentPosition(wpestate_showMyPosition_original,wpestate_errorCallback,{timeout:10000})}else{jQuery.getJSON("http://ipinfo.io",function(c){a=c.loc.split(",");wpestate_showMyPosition(a)})}}else{alert(mapfunctions_vars.geo_no_brow)}}function wpestate_errorCallback(){alert(mapfunctions_vars.geo_no_pos)}function wpestate_showMyPosition_original(h){if(wp_estate_kind_of_map===1){var c={coord:[1,1,1,38,38,59,59,1],type:"poly"};var g=new google.maps.LatLng(h.coords.latitude,h.coords.longitude);map.setCenter(g);var b=new google.maps.Marker({position:g,map:map,icon:wpestate_custompinchild(),shape:c,title:"",zIndex:999999999,image:"",price:"",category:"",action:"",link:"",infoWindowIndex:99,radius:parseInt(mapfunctions_vars.geolocation_radius,10)+" "+mapfunctions_vars.geo_message});var e={strokeColor:"#67cfd8",strokeOpacity:0.6,strokeWeight:1,fillColor:"#67cfd8",fillOpacity:0.2,map:map,center:g,radius:parseInt(mapfunctions_vars.geolocation_radius,10)};var f=new google.maps.Circle(e);var d=new Label({map:map});d.bindTo("position",b);d.bindTo("text",b,"radius");d.bindTo("visible",b);d.bindTo("clickable",b);d.bindTo("zIndex",b)}else{var a=[h.coords.latitude,h.coords.longitude];wprentals_draw_leaflet_circle(a)}}var geo_markers=[];var geo_circle=[];var geo_label=[];function wpestate_showMyPosition(a){if(wp_estate_kind_of_map===1){wpresidence_draw_google_circle(a)}else{if(wp_estate_kind_of_map===2){wprentals_draw_leaflet_circle(a)}}}function wprentals_draw_leaflet_circle(f){L.circle([f[0],f[1]],parseInt(mapfunctions_vars.geolocation_radius,10)).addTo(map);var e={iconUrl:wprentals_custompinchild_leaflet(),iconSize:[38,59],iconAnchor:[20,50],popupAnchor:[1,-50]};var b={riseOnHover:true};var d=L.latLng(f[0],f[1]);b.icon=L.icon(e);L.marker(d,b).addTo(map);var a='<div class="wpresidence_leaflet_label">';a+=parseInt(mapfunctions_vars.geolocation_radius,10)+" "+mapfunctions_vars.geo_message;a+="</div>";var c=L.divIcon({className:"someclass",iconSize:new L.Point(0,0),html:a});L.marker(d,{icon:c}).addTo(map);map.panTo(d);map.setZoom(10)}function wpresidence_draw_google_circle(h){for(var e=0;e<geo_markers.length;e++){geo_markers[e].setMap(null);geo_circle[e].setMap(null);geo_label[e].setMap(null)}geo_markers=[];geo_circle=[];geo_label=[];var b={coord:[1,1,1,38,38,59,59,1],type:"poly"};var g=new google.maps.LatLng(h[0],h[1]);map.setCenter(g);map.setZoom(13);var a=new google.maps.Marker({position:g,map:map,icon:wpestate_custompinchild(),shape:b,title:"",zIndex:999999999,image:"",price:"",category:"",action:"",link:"",infoWindowIndex:99,radius:parseInt(mapfunctions_vars.geolocation_radius,10)+" "+mapfunctions_vars.geo_message});geo_markers.push(a);var d={strokeColor:"#67cfd8",strokeOpacity:0.6,strokeWeight:1,fillColor:"#67cfd8",fillOpacity:0.2,map:map,center:g,radius:parseInt(mapfunctions_vars.geolocation_radius,10)};var f=new google.maps.Circle(d);geo_circle.push(f);var c=new Label({map:map});c.bindTo("position",a);c.bindTo("text",a,"radius");c.bindTo("visible",a);c.bindTo("clickable",a);c.bindTo("zIndex",a);geo_label.push(f)}function wpestate_custompinchild(){var c;var d="";var a=jQuery(window).dense("devicePixelRatio");if(a>1){d="_2x"}if(typeof(images.userpin)==="undefined"||images.userpin===""){c=mapfunctions_vars.path+"/userpin"+d+".png"}else{c=images.userpin;if(a>1){c=wpestate_get_custom_retina_pin(c)}}var b;if(a>1){b={url:c,size:new google.maps.Size(88,96),scaledSize:new google.maps.Size(44,48),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,59)}}else{b={url:c,size:new google.maps.Size(59,59),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,59)}}return b}if(document.getElementById("gmap")){google.maps.event.addDomListener(document.getElementById("gmap"),"mouseout",function(){google.maps.event.trigger(map,"resize")})}if(document.getElementById("search_map_button")){google.maps.event.addDomListener(document.getElementById("search_map_button"),"click",function(){infoBox.close()})}if(document.getElementById("advanced_search_map_button")){google.maps.event.addDomListener(document.getElementById("advanced_search_map_button"),"click",function(){infoBox.close()})}jQuery("#gmap-next").on("click",function(a){current_place++;external_action_ondemand=1;lealet_map_move_on_hover=1;if(current_place>gmarkers.length){current_place=1}while(gmarkers[current_place-1].visible===false){current_place++;if(current_place>gmarkers.length){current_place=1}}if(map.getZoom()<15){map.setZoom(15)}if(wp_estate_kind_of_map===1){google.maps.event.trigger(gmarkers[current_place-1],"click")}else{if(wp_estate_kind_of_map===2){map.setView(gmarkers[current_place-1].getLatLng());if(!gmarkers[current_place-1]._icon){gmarkers[current_place-1].__parent.spiderfy()}lealet_map_move_on_hover=1;map.setZoom(20);if((current_place-1)==0||(current_place-1)==gmarkers.length){setTimeout(function(){gmarkers[current_place-1].fire("click")},1000)}else{gmarkers[current_place-1].fire("click")}lealet_map_move_on_hover=1;wpestate_map_callback(wpestate_new_open_close_map)}}});jQuery("#gmap-prev").on("click",function(a){external_action_ondemand=1;lealet_map_move_on_hover=1;current_place--;if(current_place<1){current_place=gmarkers.length}while(gmarkers[current_place-1].visible===false){current_place--;if(current_place>gmarkers.length){current_place=1}}if(map.getZoom()<15){map.setZoom(15)}if(wp_estate_kind_of_map===1){google.maps.event.trigger(gmarkers[current_place-1],"click")}else{if(wp_estate_kind_of_map===2){map.setView(gmarkers[current_place-1].getLatLng());if(!gmarkers[current_place-1]._icon){gmarkers[current_place-1].__parent.spiderfy()}lealet_map_move_on_hover=1;map.setZoom(20);if((current_place-1)==0||(current_place)==gmarkers.length){setTimeout(function(){gmarkers[current_place-1].fire("click")},1000)}else{gmarkers[current_place-1].fire("click")}lealet_map_move_on_hover=1;wpestate_map_callback(wpestate_new_open_close_map)}}current_place--});jQuery(".advanced_action_div li").on("click",function(a){var b=jQuery(this).val()});if(document.getElementById("gmap-menu")){google.maps.event.addDomListener(document.getElementById("gmap-menu"),"click",function(a){infoBox.close();if(a.target.nodeName==="INPUT"){category=a.target.className;if(a.target.name==="filter_action[]"){if(actions.indexOf(category)!==-1){actions.splice(actions.indexOf(category),1)}else{actions.push(category)}}if(a.target.name==="filter_type[]"){if(categories.indexOf(category)!==-1){categories.splice(categories.indexOf(category),1)}else{categories.push(category)}}show(actions,categories)}})}function wpestate_getCookieMap(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)==0){return f.substring(b.length,f.length)}}return""}function wpestate_get_custom_value_tab_search(a){var c="";var b=0;if(a==="adv_categ"||a==="adv_actions"||a==="advanced_city"||a==="advanced_area"||a==="county-state"){c=jQuery(".tab-pane.active #"+a).attr("data-value")}else{if(a==="property_price"&&mapfunctions_vars.slider_price==="yes"){c=jQuery(".tab-pane.active #price_low").val()}else{if(a==="property-country"){c=jQuery(".tab-pane.active #advanced_country").attr("data-value")}else{if(a==="property_status"){c=jQuery(".tab-pane.active #adv_status").attr("data-value")}else{if(a==="adv_location"){c=jQuery(".tab-pane.active .adv_locations_search").val()}else{if(a!==""){if(jQuery(".tab-pane.active #"+a).hasClass("filter_menu_trigger")){c=jQuery(".tab-pane.active #"+a).attr("data-value");b=1}else{c=jQuery(".tab-pane.active #"+a).val()}}}}}}}return c}function wpestate_get_custom_value(a){var c;var b=0;if(a==="adv_categ"||a==="adv_actions"||a==="advanced_city"||a==="advanced_area"||a==="county-state"){c=jQuery("#"+a).attr("data-value")}else{if(a==="property_price"&&mapfunctions_vars.slider_price==="yes"){c=jQuery("#price_low").val()}else{if(a==="property_status"){c=jQuery("#adv_status").attr("data-value")}else{if(a==="property-country"){c=jQuery("#advanced_country").attr("data-value")}else{if(a==="adv_location"){c=jQuery(".adv_locations_search").val()}else{if(jQuery("#"+a).hasClass("filter_menu_trigger")){c=jQuery("#"+a).attr("data-value");b=1}else{c=jQuery("#"+a).val()}}}}}}if(typeof(c)!=="undefined"&&b===0){}return c}function wpestate_get_custom_value_onthelist(a){var c;var b=0;if(a==="adv_categ"||a==="adv_actions"||a==="advanced_city"||a==="advanced_area"||a==="county-state"){c=jQuery("#"+a).attr("data-value");if(a==="adv_categ"){c=jQuery("#tax_categ_picked").val()}else{if(a==="adv_actions"){c=jQuery("#tax_action_picked").val()}else{if(a==="advanced_city"){c=jQuery("#tax_city_picked").val()}else{if(a==="advanced_area"){c=jQuery("#taxa_area_picked").val()}}}}}else{if(a==="property_price"&&mapfunctions_vars.slider_price==="yes"){c=jQuery("#price_low").val()}else{if(a==="property-country"){c=jQuery("#advanced_country").attr("data-value")}else{if(jQuery("#"+a).hasClass("filter_menu_trigger")){c=jQuery("#"+a).attr("data-value");b=1}else{c=jQuery("#"+a).val()}}}}return c}function wpestate_show_pins(){jQuery("#results").show();jQuery("#results_wrapper").empty().append('<div class="preview_results_loading">'+mapfunctions_vars.loading_results+"</div>").show();var h,b,i,c,g,e,n,m,j,a,f,k,o;if(typeof infoBox!=="undefined"&&infoBox!==null){infoBox.close()}jQuery("#gmap-loading").show();if(typeof(googlecode_regular_vars)!="undefined"){if((mapfunctions_vars.adv_search_type==="8"||mapfunctions_vars.adv_search_type==="9")&&mapfunctions_vars.is_half_map_list!=="1"){wpestate_show_pins_type2_tabs();return}if(mapfunctions_vars.adv_search_type==="2"&&mapfunctions_vars.is_half_map_list!=="1"&&mapfunctions_vars.is_adv_search!=="1"){wpestate_show_pins_type2();return}}else{if((mapfunctions_vars.adv_search_type==="8"||mapfunctions_vars.adv_search_type==="9")){wpestate_show_pins_type2_tabs();return}if(mapfunctions_vars.adv_search_type==="2"&&mapfunctions_vars.is_half_map_list!=="1"){wpestate_show_pins_type2();return}}if(mapfunctions_vars.custom_search==="yes"){wpestate_show_pins_custom_search();return}h=jQuery("#adv_actions").attr("data-value");b=jQuery("#adv_categ").attr("data-value");i=jQuery("#advanced_city").attr("data-value");c=jQuery("#advanced_area").attr("data-value");g=parseFloat(jQuery("#adv_rooms").val(),10);e=parseFloat(jQuery("#adv_bath").val(),10);n=parseFloat(jQuery("#price_low").val(),10);m=parseFloat(jQuery("#price_max").val(),10);a=parseFloat(jQuery("#adv-search-1").attr("data-postid"),10);j=ajaxcalls_vars.admin_url+"admin-ajax.php";if(parseInt(mapfunctions_vars.is_half)===1){if(first_time_wpestate_show_inpage_ajax_half===0){first_time_wpestate_show_inpage_ajax_half=1}else{wpestate_show_inpage_ajax_half()}}k="";jQuery('.search_wrapper .extended_search_check_wrapper  input[type="checkbox"]').each(function(){if(jQuery(this).is(":checked")){k=k+","+jQuery(this).attr("name-title")}});f=0;o=0;if(jQuery("#google_map_prop_list_sidebar").length){f=1}a=1;if(document.getElementById("search_wrapper")){a=parseInt(jQuery("#search_wrapper").attr("data-postid"),10)}var q="";var d="";var p="";if(jQuery("#geolocation_search").length>0){q=jQuery("#geolocation_lat").val();d=jQuery("#geolocation_long").val();p=jQuery("#geolocation_radius").val()}var l=jQuery("#wpestate_ajax_filtering").val();jQuery.ajax({type:"POST",url:j,dataType:"json",data:{action:"wpestate_classic_ondemand_pin_load",action_values:h,category_values:b,city:i,area:c,advanced_rooms:g,advanced_bath:e,price_low:n,price_max:m,newpage:o,postid:a,halfmap:f,all_checkers:k,geo_lat:q,geo_long:d,geo_rad:p,security:l},success:function(s){var r=parseInt(s.no_results);if(r!==0){wpestate_load_on_demand_pins(s.markers,r,1)}else{wpestate_show_no_results()}jQuery("#gmap-loading").hide()},error:function(r){}})}function wpestate_show_pins_type2(){var e,c,a,f,b,d,g,i;e=jQuery("#adv_actions").attr("data-value");c=jQuery("#adv_categ").attr("data-value");a=jQuery("#adv_location").val();b=parseInt(jQuery("#adv-search-1").attr("data-postid"),10);f=ajaxcalls_vars.admin_url+"admin-ajax.php";d=0;i=0;if(jQuery("#google_map_prop_list_sidebar").length){d=1}b=1;if(document.getElementById("search_wrapper")){b=parseInt(jQuery("#search_wrapper").attr("data-postid"),10)}var h=jQuery("#wpestate_ajax_filtering").val();jQuery.ajax({type:"POST",url:f,dataType:"json",data:{action:"wpestate_classic_ondemand_pin_load_type2",action_values:e,category_values:c,location:a,security:h},success:function(k){var j=parseInt(k.no_results);if(j!==0){wpestate_load_on_demand_pins(k.markers,j,1)}else{wpestate_show_no_results()}jQuery("#gmap-loading").hide()},error:function(j){}});if(parseInt(mapfunctions_vars.is_half)===1){if(first_time_wpestate_show_inpage_ajax_half===0){first_time_wpestate_show_inpage_ajax_half=1}else{wpestate_show_inpage_ajax_half()}}}function wpestate_show_pins_type2_tabs(){var e,c,a,g,b,d,i,k,h;e=jQuery(".tab-pane.active #adv_actions").attr("data-value");if(typeof e==="undefined"){e=""}c=jQuery(".tab-pane.active #adv_categ").attr("data-value");if(typeof c==="undefined"){c=""}a=jQuery(".tab-pane.active #adv_location").val();h=jQuery(".tab-pane.active .picked_tax").val();b=parseInt(jQuery("#adv-search-1").attr("data-postid"),10);g=ajaxcalls_vars.admin_url+"admin-ajax.php";g=ajaxcalls_vars.wpestate_ajax;d=0;k=0;if(jQuery("#google_map_prop_list_sidebar").length){d=1}b=1;if(document.getElementById("search_wrapper")){b=parseInt(jQuery("#search_wrapper").attr("data-postid"),10)}var f=jQuery(".tab-pane.active .term_id_class").val();i="";jQuery('.tab-pane.active .extended_search_check_wrapper input[type="checkbox"]').each(function(){if(jQuery(this).is(":checked")){i=i+","+jQuery(this).attr("name-title")}});var j=jQuery("#wpestate_ajax_filtering").val();jQuery.ajax({type:"POST",url:g,dataType:"json",data:{action:"wpestate_classic_ondemand_pin_load_type2_tabs",action_values:e,category_values:c,location:a,picked_tax:h,all_checkers:i,security:j},success:function(m){var l=parseInt(m.no_results);if(l!==0){wpestate_load_on_demand_pins(m.markers,l,1)}else{wpestate_show_no_results()}jQuery("#gmap-loading").hide()},error:function(l){}});if(parseInt(mapfunctions_vars.is_half)===1){if(first_time_wpestate_show_inpage_ajax_half===0){first_time_wpestate_show_inpage_ajax_half=1}else{wpestate_show_inpage_ajax_half()}}}function wpestate_show_pins_custom_search(){var t,c,D,f,z,x,C,B,a,q,k,m,e,n,o;t=ajaxcalls_vars.wpestate_ajax;B=0;D=parseInt(mapfunctions_vars.fields_no,10);c=D;x=[];z=[];f=[];z=mapfunctions_vars.slugs;f=mapfunctions_vars.hows;var v=0;if(mapfunctions_vars.slider_price==="yes"){n=jQuery("#price_low").val();o=jQuery("#price_max").val()}var u;v=parseInt(jQuery(".tab-pane.active").find(".term_counter").val(),10);if((mapfunctions_vars.adv_search_type==="6"||mapfunctions_vars.adv_search_type==="7")){q=jQuery(".tab-pane.active .term_id_class").val();if(mapfunctions_vars.slider_price==="yes"){n=jQuery("#price_low_"+q).val();o=jQuery("#price_max_"+q).val()}var h=v*mapfunctions_vars.fields_no;if(v>0){D=(D*v)+D}for(u=h;u<D;u++){if(f[u]=="date bigger"||f[u]=="date smaller"){a=wpestate_get_custom_value_tab_search(q+z[u])}else{a=wpestate_get_custom_value_tab_search(z[u])}if(typeof(a)==="undefined"){a=""}x.push(a)}}else{for(u=0;u<D;u++){a=wpestate_get_custom_value(z[u]);if(typeof(a)==="undefined"){a=""}x.push(a)}}if((mapfunctions_vars.adv_search_type==="6"||mapfunctions_vars.adv_search_type==="7"||mapfunctions_vars.adv_search_type==="8"||mapfunctions_vars.adv_search_type==="9")){var p=jQuery(".adv_search_tab_item.active").attr("data-tax");if(jQuery(".halfsearch")[0]){p=jQuery(".halfsearch").attr("data-tax")}if(p==="property_category"){z[D]="adv_categ"}else{if(p==="property_action_category"){z[D]="adv_actions"}else{if(p==="property_city"){z[D]="advanced_city"}else{if(p==="property_area"){z[D]="advanced_area"}else{if(p==="property_county_state"){z[D]="county-state"}}}}}f[D]="like";x[c]=jQuery(".adv_search_tab_item.active").attr("data-term")}if(parseInt(mapfunctions_vars.is_half)===1){if(first_time_wpestate_show_inpage_ajax_half===0){first_time_wpestate_show_inpage_ajax_half=1}else{wpestate_show_inpage_ajax_half()}}var r="";if(mapfunctions_vars.adv_search_type==="6"){jQuery('.tab-pane.active .extended_search_check_wrapper  input[type="checkbox"]').each(function(){if(jQuery(this).is(":checked")){r=r+","+jQuery(this).attr("name-title")}})}else{jQuery('.search_wrapper .extended_search_check_wrapper  input[type="checkbox"]').each(function(){if(jQuery(this).is(":checked")){r=r+","+jQuery(this).attr("name-title")}})}k=0;m=0;if(jQuery("#google_map_prop_list_sidebar").length){k=1}e=1;if(document.getElementById("search_wrapper")){e=parseInt(jQuery("#search_wrapper").attr("data-postid"),10)}var l="";var y="";if(mapfunctions_vars.adv_search_type==="10"){l=jQuery("#adv_actions").attr("data-value");y=jQuery("#adv_location").val()}var j="";var d="";var b="";if(mapfunctions_vars.adv_search_type==="11"){j=jQuery("#adv_actions").attr("data-value");d=jQuery("#adv_categ").attr("data-value");b=jQuery("#keyword_search").val()}var s="";var A="";var g="";if(jQuery("#geolocation_search").length>0){s=jQuery("#geolocation_lat").val();A=jQuery("#geolocation_long").val();g=jQuery("#geolocation_radius").val()}var w=jQuery("#wpestate_ajax_filtering").val();jQuery.ajax({type:"POST",url:t,dataType:"json",data:{action:"wpestate_custom_ondemand_pin_load",search_type:mapfunctions_vars.adv_search_type,val_holder:x,newpage:m,postid:e,halfmap:k,slider_min:n,slider_max:o,all_checkers:r,filter_search_action10:l,adv_location10:y,filter_search_action11:j,filter_search_categ11:d,keyword_search:b,geo_lat:s,geo_long:A,geo_rad:g,term_counter:v,security:w},success:function(E){var i=parseInt(E.no_results);if(i!==0){wpestate_load_on_demand_pins(E.markers,i,1)}else{wpestate_show_no_results()}jQuery("#gmap-loading").hide()},error:function(i){}})}function wpestate_empty_map(){if(typeof gmarkers!=="undefined"){if(wp_estate_kind_of_map==1){for(var a=0;a<gmarkers.length;a++){gmarkers[a].setVisible(false);gmarkers[a].setMap(null)}gmarkers=[];if(typeof(mcluster)!=="undefined"){mcluster.clearMarkers()}}else{if(wp_estate_kind_of_map==2){if(typeof map!="undefined"){if(mapfunctions_vars.user_cluster==="yes"){map.removeLayer(markers_cluster)}else{for(var a=0;a<gmarkers.length;a++){map.removeLayer(gmarkers[a])}}gmarkers=[];markers_cluster=L.markerClusterGroup({showCoverageOnHover:false,iconCreateFunction:function(b){return L.divIcon({html:'<div class="leaflet_cluster">'+b.getChildCount()+"</div>"})},});map.addLayer(markers_cluster)}}}}}function wpestate_load_on_demand_pins(e,b,c){jQuery("#gmap-noresult").hide();wpestate_empty_map();if(document.getElementById("googleMap")){bounds_list=undefined;wpresidence_map_general_set_markers(map,e,1);wpestate_preview_listings(e);wpresidence_map_general_cluster();wpresidence_map_general_fit_to_bounds(1)}else{wpestate_preview_listings(e)}if(jQuery("#geolocation_search").length>0&&initialGeop===0){var a=jQuery("#geolocation_lat").val();var d=jQuery("#geolocation_long").val();if(a!==""&&d!=""){initialGeop=1;wpestate_geolocation_marker(a,d)}}}function wpestate_preview_listings(h){var a=0;var b="";var f="";var g="";var d="";var e="";var c="";for(a=0;a<h.length;a++){f=decodeURIComponent(h[a][18]);g=decodeURIComponent(h[a][0]);d=decodeURIComponent(h[a][9]);e=decodeURIComponent(h[a][11]);c=wpestate_get_price_currency(decodeURIComponent(h[a][5]),e);b=b+'<div class="preview_listing_unit" data-href="'+d+'">'+f+" <h4>"+g+'</h4><div class="preview_details">'+c+"</div></div>"}jQuery("#results_wrapper").empty();jQuery("#results_no").show().text(h.length);jQuery("#results_wrapper").append(b);jQuery(".preview_listing_unit").on("click",function(i){i.preventDefault();var j;j=jQuery(this).attr("data-href");window.open(j,"_self",false)})}function wpestate_get_price_currency(e,i){var g="";var b=decodeURIComponent(wpestate_getCookie_map("my_custom_curr_symbol"));var h=parseFloat(wpestate_getCookie_map("my_custom_curr_coef"));var f=parseFloat(wpestate_getCookie_map("my_custom_curr_pos"));var c=wpestate_getCookie_map("my_custom_curr_cur_post");var d=0;if(!isNaN(f)&&f!==-1){var a=Number(i*h).toFixed(2);if(c==="before"){g=b+" "+a}else{g=a+" "+b}}else{g=e}return g}function wpestate_getCookie_map(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)==0){return f.substring(b.length,f.length)}}return""}function wpestate_show_no_results(){jQuery("#results_no").show().text("0");jQuery("#results_wrapper").empty().append('<div class="preview_results_loading">'+mapfunctions_vars.half_no_results+"</div>").show();jQuery("#gmap-noresult").show();if(document.getElementById("google_map_prop_list_wrapper")){jQuery("#listing_ajax_container").empty().append('<p class=" no_results_title ">'+mapfunctions_vars.half_no_results+"</p>")}}function wpestate_show_inpage_ajax_tip2(){if(jQuery("#gmap-full").hasClass("spanselected")){jQuery("#gmap-full").trigger("click")}if(mapfunctions_vars.custom_search==="yes"){wpestate_custom_search_start_filtering_ajax(1)}else{wpestate_start_filtering_ajax(1)}}function wpestate_show_inpage_ajax_half(){jQuery(".half-pagination").remove();if(mapfunctions_vars.custom_search==="yes"){wpestate_custom_search_start_filtering_ajax(1)}else{wpestate_start_filtering_ajax(1)}}function wpestate_enable_half_map_pin_action(){jQuery("#google_map_prop_list_sidebar .listing_wrapper").on({mouseenter:function(){var a=jQuery(this).attr("data-listid");wpestate_hover_action_pin(a)},mouseleave:function(){var a=jQuery(this).attr("data-listid");wpestate_return_hover_action_pin(a)}})}function wpestate_convertToSlug(a){return a.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")}function wpestate_get_custom_retina_pin(b){var a;a=b.replace(".png","_2x.png");jQuery.get(a).done(function(){b=a}).fail(function(){});return b}function wpestate_custompin(b){var d="";var a=jQuery(window).dense("devicePixelRatio");if(a>1){d="_2x"}var c;if(mapfunctions_vars.use_single_image_pin==="no"){if(b!==""){if(typeof(images[b])==="undefined"||images[b]===""){c=mapfunctions_vars.path+"/"+b+d+".png"}else{c=images[b];if(a>1){c=wpestate_get_custom_retina_pin(c)}}}else{c=mapfunctions_vars.path+"/none.png"}if(typeof(c)==="undefined"){c=mapfunctions_vars.path+"/none.png"}}else{if(a>1){c=wpestate_get_custom_retina_pin(images.single_pin)}else{c=images.single_pin}}if(a>1){b={url:c,size:new google.maps.Size(118,118),scaledSize:new google.maps.Size(44,48),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,49),optimized:false}}else{b={url:c,size:new google.maps.Size(59,59),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,49)}}return b}function Label(b){this.setValues(b);var a=this.span_=document.createElement("span");a.style.cssText="position: relative; left: -50%; top: 8px; white-space: nowrap;  padding: 2px; background-color: white;opacity:0.7";var c=this.div_=document.createElement("div");c.appendChild(a);c.style.cssText="position: absolute; display: none"}if(typeof google!=="undefined"){Label.prototype=new google.maps.OverlayView}Label.prototype.onAdd=function(){var b=this.getPanes().overlayImage;b.appendChild(this.div_);var a=this;this.listeners_=[google.maps.event.addListener(this,"position_changed",function(){a.draw()}),google.maps.event.addListener(this,"visible_changed",function(){a.draw()}),google.maps.event.addListener(this,"clickable_changed",function(){a.draw()}),google.maps.event.addListener(this,"text_changed",function(){a.draw()}),google.maps.event.addListener(this,"zindex_changed",function(){a.draw()}),google.maps.event.addDomListener(this.div_,"click",function(){if(a.get("clickable")){google.maps.event.trigger(a,"click")}})]};Label.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_);for(var b=0,a=this.listeners_.length;b<a;++b){google.maps.event.removeListener(this.listeners_[b])}};Label.prototype.draw=function(){var c=this.getProjection();var b=c.fromLatLngToDivPixel(this.get("position"));var f=this.div_;f.style.left=b.x+"px";f.style.top=b.y+"px";var d=this.get("visible");f.style.display=d?"block":"none";var a=this.get("clickable");this.span_.style.cursor=a?"pointer":"";var e=this.get("zIndex");f.style.zIndex=e;this.span_.innerHTML=this.get("text").toString()};function wpestate_close_adv_search(){}function wpestate_new_show_advanced_search(){jQuery("#search_wrapper").removeClass("hidden")}function wpestate_new_hide_advanced_search(){if(mapfunctions_vars.show_adv_search==="no"){jQuery("#search_wrapper").addClass("hidden")}}function wpestate_hover_action_pin(a){for(var b=0;b<gmarkers.length;b++){if(parseInt(gmarkers[b].idul,10)===parseInt(a,10)){if(wp_estate_kind_of_map===1){google.maps.event.trigger(gmarkers[b],"click");if(mapfunctions_vars.useprice!=="yes"){pin_hover_storage=gmarkers[b].icon;gmarkers[b].setIcon(wpestate_custompinhover())}}else{if(wp_estate_kind_of_map===2){lealet_map_move_on_hover=1;if(!gmarkers[b]._icon){gmarkers[b].__parent.spiderfy()}map.panTo(gmarkers[b].getLatLng());gmarkers[b].togglePopup();if(mapfunctions_vars.useprice!=="yes"){gmarkers[b].setIcon(wpestate_custompinhover())}}}}}}function wpestate_return_hover_action_pin(a){for(var b=0;b<gmarkers.length;b++){if(parseInt(gmarkers[b].idul,10)===parseInt(a,10)){if(wp_estate_kind_of_map===1){if(parseInt(gmarkers[b].idul,10)===parseInt(a,10)){infoBox.close();if(mapfunctions_vars.useprice!=="yes"){gmarkers[b].setIcon(pin_hover_storage)}}}else{if(wp_estate_kind_of_map===2){gmarkers[b].togglePopup();lealet_map_move_on_hover=0;if(mapfunctions_vars.useprice!=="yes"){var c=L.icon({iconUrl:wprentals_custompin_leaflet(gmarkers[b].pin),iconSize:[44,50],iconAnchor:[20,50],popupAnchor:[1,-50]});gmarkers[b].setIcon(c)}}}}}}function wpestate_custompinhover(){var d,c;var e="";var a=jQuery(window).dense("devicePixelRatio");if(a>1){e="_2x"}d=mapfunctions_vars.path+"/hover"+e+".png";if(wp_estate_kind_of_map===2){if(a>1){var b=L.icon({iconUrl:d,iconSize:[90,90],iconAnchor:[40,90],popupAnchor:[1,-90]})}else{var b=L.icon({iconUrl:d,iconSize:[44,50],iconAnchor:[20,50],popupAnchor:[1,-50]})}return b}if(a>1){c={url:d,size:new google.maps.Size(132,144),scaledSize:new google.maps.Size(66,72),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(25,72)}}else{c={url:d,size:new google.maps.Size(90,90),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(25,72)}}return c}function wpestate_map_callback(a){a(1)}var wpestate_initialize_poi=function(h,j){if(parseInt(mapbase_vars.wp_estate_kind_of_map)==2||typeof(google.maps.places)==="undefined"){return}var d=new google.maps.places.PlacesService(h);var a="";var k="";var b=h.getBounds();var f=".google_poi";if(j==2){f=".google_poish"}jQuery(f).on("click",function(n){n.stopPropagation();poi_type=jQuery(this).attr("id");var l=h.getCenter();var o=i(poi_type);if(jQuery(this).hasClass("poi_active")){c(poi_type,"hide")}else{a=c(poi_type,"show");if(a===1){var m={location:l,types:o,bounds:b,radius:2500,};d.nearbySearch(m,function(q,p){g(q,p,h)})}}jQuery(this).toggleClass("poi_active")});var i=function(m){var l;switch(m){case"transport":l=["bus_station","airport","train_station","subway_station"];break;case"supermarkets":l=["grocery_or_supermarket","shopping_mall"];break;case"schools":l=["school","university"];break;case"restaurant":l=["restaurant"];break;case"pharma":l=["pharmacy"];break;case"hospitals":l=["hospital"];break}return l};var g=function(q,m,p){var l,o;if(google.maps.places.PlacesServiceStatus.OK==m){for(var n=0;n<q.length;n++){o=e(q[n],p);poi_marker_array.push(o)}}};var e=function(m,o){var l=new google.maps.Marker({map:o,position:m.geometry.location,show_poi:poi_type,icon:mapfunctions_vars.path+"/poi/"+poi_type+".png"});var n=document.createElement("div");var p=new InfoBox({content:n,boxClass:"estate_poi_box",pixelOffset:new google.maps.Size(-30,-70),zIndex:null,maxWidth:275,closeBoxMargin:"-13px 0px 0px 0px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),pane:"floatPane",enableEventPropagation:false});google.maps.event.addListener(l,"mouseover",function(q){p.setContent(m.name);p.open(o,this)});google.maps.event.addListener(l,"mouseout",function(q){if(p!==null){p.close()}});return l};var c=function(o,m){var l=1;for(var n=0;n<poi_marker_array.length;n++){if(poi_marker_array[n].show_poi===o){if(m==="hide"){poi_marker_array[n].setVisible(false)}else{poi_marker_array[n].setVisible(true);l=0}}}return l}};function wpestate_geolocation_marker(b,c){var e;if(control_vars.geo_radius_measure==="miles"){e=parseInt(jQuery("#geolocation_radius").val(),10)*1609.34}else{e=parseInt(jQuery("#geolocation_radius").val(),10)*1000}if(wp_estate_kind_of_map===1){var g=new google.maps.LatLng(b,c);map.setCenter(g);if(placeCircle!=""){placeCircle.setMap(null);placeCircle=""}var f=new google.maps.Marker({map:map,position:g,icon:mapfunctions_vars.path+"/poi/location.png"});var h={strokeColor:"#67cfd8",strokeOpacity:0.6,strokeWeight:1,fillColor:"#1CA8DD",fillOpacity:0.2,map:map,center:g,radius:parseInt(e,10)};placeCircle=new google.maps.Circle(h);map.fitBounds(placeCircle.getBounds())}else{var i=L.latLng(b,c);map.panTo(i);if(map.hasLayer(circleLayer)){map.removeLayer(circleLayer)}var d={iconUrl:mapfunctions_vars.path+"/poi/location.png",iconSize:[28,38],iconAnchor:[10,19],popupAnchor:[1,-18]};var a={riseOnHover:true};if(map.hasLayer(circleLayer)){map.removeLayer(circleLayer)}circleLayer=L.featureGroup();a.icon=L.icon(d);L.marker(i,a).addTo(map);placeCircle=L.circle(i,parseInt(e,10)).addTo(circleLayer);map.addLayer(circleLayer);map.fitBounds(placeCircle.getBounds())}}function wpestate_makeSafeForCSS(a){return a.replace(/[^a-z0-9]/g,function(b){var d=b.charCodeAt(0);if(d==32){return"-"}if(d>=65&&d<=90){return b.toLowerCase()}return("000"+d.toString(16)).slice(-4)})};