
var map="";var selected_city="";var geocoder;var gmarkers=[];var propertyMarker_submit;jQuery(document).ready(function(b){if(parseInt(admin_google_vars.wpresidence_map_type)===1){google.maps.event.addDomListener(window,"load",wpresidence_admin_submit_initialize)}else{wpresidence_admin_submit_initialize()}var a=document.getElementById("property_map_trigger");if(a!==null){jQuery("#property_map_trigger").on("click",function(){if(parseInt(admin_google_vars.wpresidence_map_type)===1){google.maps.event.trigger(map,"resize")}else{}})}});function wpresidence_admin_submit_initialize(){if(parseInt(admin_google_vars.wpresidence_map_type)===1){var f=new google.maps.LatLng(admin_google_vars.general_latitude,admin_google_vars.general_longitude);var b={flat:false,noClear:false,zoom:17,scrollwheel:false,draggable:true,center:f,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("googleMap"),b);google.maps.visualRefresh=true;var a=new google.maps.Marker({position:f});a.setMap(map);gmarkers.push(a);google.maps.event.addListener(map,"click",function(g){wpestate_placeMarker(g.latLng);google.maps.visualRefresh=true});map.setCenter(f)}else{if(parseInt(admin_google_vars.wpresidence_map_type)===2){var d=L.latLng(admin_google_vars.general_latitude,admin_google_vars.general_longitude);map=L.map("googleMap",{center:d,zoom:15,});var e=wpresidence_open_stret_tile_details_admin();map.addLayer(e);map.on("click",function(h){map.removeLayer(propertyMarker_submit);var g=L.latLng(h.latlng);propertyMarker_submit=L.marker(h.latlng).addTo(map);propertyMarker_submit.bindPopup('<div class="submit_leaflet_admin">Latitude: '+h.latlng.lat+" Longitude: "+h.latlng.lng+"</div>").openPopup();jQuery("#property_latitude").val(h.latlng.lat);jQuery("#property_longitude").val(h.latlng.lng);jQuery("#agency_lat").val(h.latlng.lat);jQuery("#agency_long").val(h.latlng.lng);jQuery("#developer_lat").val(h.latlng.lat);jQuery("#developer_long").val(h.latlng.lng)});var c=L.latLng(d);propertyMarker_submit=L.marker(c).addTo(map);propertyMarker_submit.bindPopup('<div class="submit_leaflet_admin">Latitude: '+admin_google_vars.general_latitude+" Longitude: "+admin_google_vars.general_longitude+"</div>");jQuery("#property_map_trigger").on("click",function(){setTimeout(function(){map.invalidateSize()},600);setTimeout(function(){propertyMarker_submit.openPopup()},600)})}}}function wpresidence_open_stret_tile_details_admin(){if(admin_google_vars.wp_estate_mapbox_api_key===""){var a=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'})}else{var a=L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token="+admin_google_vars.wp_estate_mapbox_api_key,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:18,id:"mapbox.streets",accessToken:"your.mapbox.access.token"})}return a}function wpestate_placeMarker(b){wpestate_removeMarkersadmin();var a=new google.maps.Marker({position:b,map:map});var c;gmarkers.push(a);var d=new google.maps.InfoWindow({content:"Latitude: "+b.lat()+"<br>Longitude: "+b.lng()});d.open(map,a);c=document.getElementById("property_latitude");if(c!==null){document.getElementById("property_latitude").value=b.lat();document.getElementById("property_longitude").value=b.lng()}c=document.getElementById("agency_lat");if(c!==null){document.getElementById("agency_lat").value=b.lat();document.getElementById("agency_long").value=b.lng()}c=document.getElementById("developer_lat");if(c!==null){document.getElementById("developer_lat").value=b.lat();document.getElementById("developer_long").value=b.lng()}}function wpestate_removeMarkersadmin(){for(var a=0;a<gmarkers.length;a++){gmarkers[a].setMap(null)}}jQuery("#admin_place_pin").on("click",function(a){a.preventDefault();wpestate_admin_codeAddress()});jQuery("#property_citychecklist label").on("click",function(a){selected_city=jQuery(this).text()});function wpestate_admin_codeAddress(){var b,f;var i="";var g,j;var a="";if(jQuery("#property_address").length>0){i=document.getElementById("property_address").value;var h=jQuery("#property_city-all input:checked").parent();f=h.text();h=jQuery("#property_county_state-all input:checked").parent();b=h.text();var c=document.getElementById("property_country").value}else{if(jQuery("#developer_address").length>0){i=document.getElementById("developer_address").value;var h=jQuery("#property_city_developer-all input:checked").parent();f=h.text();h=jQuery("#property_county_state_developer-all input:checked").parent();b=h.text();var c=""}else{if(jQuery("#agency_address").length>0){i=document.getElementById("agency_address").value;var h=jQuery("#city_agency-all input:checked").parent();f=h.text();h=jQuery("#county_state_agency-all input:checked").parent();b=h.text();var c=""}}}var e=i;if(f){e=e+","+f}if(b){e=e+","+b}if(c){e=e+","+c}a=i+","+f+","+c;if(parseInt(admin_google_vars.geolocation_type)==1){geocoder=new google.maps.Geocoder();geocoder.geocode({address:e},function(l,k){if(k==google.maps.GeocoderStatus.OK){g=l[0].geometry.location.lat();j=l[0].geometry.location.lng();wpresidence_internalmap_set_postion(g,j)}else{alert(admin_google_vars.geo_fails+k)}})}else{if(parseInt(admin_google_vars.geolocation_type)==2){var d=jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",addressdetails:"1",q:a}).done(function(k){if(typeof(k[0])!="undefined"){g=k[0].lat;j=k[0].lon;wpresidence_internalmap_set_postion(g,j)}else{alert(admin_google_vars.geo_fails+status)}}).fail(function(){}).always(function(){})}}}function wpresidence_internalmap_set_postion(e,d){wpestate_removeMarkersadmin();if(parseInt(admin_google_vars.wpresidence_map_type)===1){var g=new google.maps.LatLng(e,d);map.setCenter(g);var a=new google.maps.Marker({map:map,position:g});gmarkers.push(a);var f=new google.maps.InfoWindow({content:"Latitude: "+e+"<br>Longitude: "+d});f.open(map,a)}else{if(parseInt(admin_google_vars.wpresidence_map_type)===2){map.removeLayer(propertyMarker_submit);var c=L.latLng(e,d);var b=L.latLng(c);propertyMarker_submit=L.marker(b).addTo(map);propertyMarker_submit.bindPopup('<div class="submit_leaflet_admin">Latitude: '+e+" Longitude: "+d+"</div>").openPopup();map.panTo(new L.LatLng(e,d))}}jQuery("#property_latitude").val(e);jQuery("#property_longitude").val(d);jQuery("#developer_lat").val(e);jQuery("#developer_long").val(d);jQuery("#agency_lat").val(e);jQuery("#agency_long").val(d)};